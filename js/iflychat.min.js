function drupalchatCreateCookie(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function drupalchatReadCookie(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function drupalchatEraseCookie(e){drupalchatCreateCookie(e,"",-1)}function drupalchatCheckUrl(e,t){(function(n){if(n.browser.msie&&window.XDomainRequest){var r=new XDomainRequest;r.open("get",e);r.onload=function(){n("body").append("<style>"+r.responseText+"</style>");drupalchatLoad(t)};r.onerror=function(e){drupalchatForceLoad()};r.send()}else{var i=new XMLHttpRequest;i.open("GET",e,true);i.send();i.onreadystatechange=function(){if(i.readyState==4&&i.status==200){n("body").append("<style>"+i.responseText+"</style>");drupalchatLoad(t)}else if(i.readyState==4&&i.status!=200){drupalchatForceLoad()}}}})(jQuery)}function drupalchatForceLoad(){(function(e){e.post(Drupal.settings.drupalchat.geturl,{action:"iflychat-get"},function(e){drupalchatLoad(e);if(Drupal.settings.drupalchat.chat_type==="2"){drupalchatCreateCookie("iflychat_key",e.key,30);drupalchatCreateCookie("iflychat_css",e.css,30);drupalchatCreateCookie("iflychat_time",(new Date).getTime(),30)}})})(jQuery)}function drupalchatLoad(e){if(e&&typeof e.css!="undefined"&&typeof e.key!="undefined"){Drupal.settings.drupalchat.session_key=e.key;if(typeof e.name!=="undefined"){Drupal.settings.drupalchat.username=e.name}if(typeof e.uid!=="undefined"){Drupal.settings.drupalchat.uid=e.uid}if(typeof e.up!=="undefined"){Drupal.settings.drupalchat.up=e.up}if(typeof e.upl!=="undefined"){Drupal.settings.drupalchat.upl=e.upl}if(Drupal.settings.drupalchat.chat_type==="2"){if(typeof e.cache==="undefined"){LazyLoad.css(Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/i/"+e.css+"/cache.css",function(){LazyLoad.js([Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/j/cache.js",Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/h/"+e.css+"/cache.js"],function(){})})}else{LazyLoad.js([Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/j/cache.js",Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/h/"+e.css+"/cache.js"],function(){})}}else{LazyLoad.css(Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/i/"+e.css+"/s/"+(Drupal.settings.drupalchat.admin=="1"?"a/":"")+"cache.css",function(){LazyLoad.js([Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/j/cache.js",Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/h/"+e.css+"/s"+(Drupal.settings.drupalchat.admin=="1"?"/a":"")+"/cache.js"],function(){})})}}}window.emotify=function(){var e,t,n={},r=[];e=function(e,i){i=i||function(e,t,n,r){t=(t+", "+n).replace(/"/g,"&quot;").replace(/</g,"&lt;");return'<img src="'+e+'" title="'+t+'" alt="" class="smiley"/>'};return e.replace(t,function(e,t,s){var o=0,u=s,a=n[s];if(!a){while(o<r.length&&!r[o].regexp.test(s)){o++}u=r[o].name;a=n[u]}return a?t+i(a[0],a[1],u,s):e})};e.emoticons=function(){var e=Array.prototype.slice.call(arguments),i=typeof e[0]==="string"?e.shift():"",s=typeof e[0]==="boolean"?e.shift():false,o=e[0],u,a=[],f,l,c;if(o){if(s){n={};r=[]}for(u in o){n[u]=o[u];n[u][0]=i+n[u][0]}for(u in n){if(n[u].length>2){f=n[u].slice(2).concat(u);l=f.length;while(l--){if(typeof f[l]!="undefined")f[l]=f[l].replace(/(\W)/g,"\\$1")}c=f.join("|");r.push({name:u,regexp:new RegExp("^"+c+"$")})}else{c=u.replace(/(\W)/g,"\\$1")}a.push(c)}t=new RegExp("(^|\\s)("+a.join("|")+")(?=(?:$|\\s))","g")}return n};return e}();(function(e){e.titleAlert=function(t,n){if(e.titleAlert._running){e.titleAlert.stop()}e.titleAlert._settings=n=e.extend({},e.titleAlert.defaults,n);if(n.requireBlur&&e.titleAlert.hasFocus){return}n.originalTitleInterval=n.originalTitleInterval||n.interval;e.titleAlert._running=true;e.titleAlert._initialText=document.title;document.title=t;var r=true;var i=function(){if(!e.titleAlert._running){return}r=!r;document.title=r?t:e.titleAlert._initialText;e.titleAlert._intervalToken=setTimeout(i,r?n.interval:n.originalTitleInterval)};e.titleAlert._intervalToken=setTimeout(i,n.interval);if(n.stopOnMouseMove){e(document).mousemove(function(t){e(this).unbind(t);e.titleAlert.stop()})}if(n.duration>0){e.titleAlert._timeoutToken=setTimeout(function(){e.titleAlert.stop()},n.duration)}};e.titleAlert.defaults={interval:500,originalTitleInterval:null,duration:0,stopOnFocus:true,requireBlur:false,stopOnMouseMove:false};e.titleAlert.stop=function(){clearTimeout(e.titleAlert._intervalToken);clearTimeout(e.titleAlert._timeoutToken);document.title=e.titleAlert._initialText;e.titleAlert._timeoutToken=null;e.titleAlert._intervalToken=null;e.titleAlert._initialText=null;e.titleAlert._running=false;e.titleAlert._settings=null};e.titleAlert.hasFocus=true;e.titleAlert._running=false;e.titleAlert._intervalToken=null;e.titleAlert._timeoutToken=null;e.titleAlert._initialText=null;e.titleAlert._settings=null;e.titleAlert._focus=function(){e.titleAlert.hasFocus=true;if(e.titleAlert._running&&e.titleAlert._settings.stopOnFocus){var t=e.titleAlert._initialText;e.titleAlert.stop();setTimeout(function(){if(e.titleAlert._running){return}document.title=".";document.title=t},1e3)}};e.titleAlert._blur=function(){e.titleAlert.hasFocus=false};e(window).bind("focus",e.titleAlert._focus);e(window).bind("blur",e.titleAlert._blur)})(jQuery);LazyLoad=function(e){function t(t,n){var r=e.createElement(t),i;for(i in n)n.hasOwnProperty(i)&&r.setAttribute(i,n[i]);return r}function n(e){var t=f[e],n,r;if(t)n=t.callback,r=t.urls,r.shift(),l=0,r.length||(n&&n.call(t.context,t.obj),f[e]=null,c[e].length&&i(e))}function r(){var t=navigator.userAgent;u={async:e.createElement("script").async===!0};(u.webkit=/AppleWebKit\//.test(t))||(u.ie=/MSIE/.test(t))||(u.opera=/Opera/.test(t))||(u.gecko=/Gecko\//.test(t))||(u.unknown=!0)}function i(i,l,h,d,v){var g=function(){n(i)},y=i==="css",b=[],E,S,x,T;u||r();if(l)if(l=typeof l==="string"?[l]:l.concat(),y||u.async||u.gecko||u.opera)c[i].push({urls:l,callback:h,obj:d,context:v});else{E=0;for(S=l.length;E<S;++E)c[i].push({urls:[l[E]],callback:E===S-1?h:null,obj:d,context:v})}if(!f[i]&&(T=f[i]=c[i].shift())){a||(a=e.head||e.getElementsByTagName("head")[0]);l=T.urls;E=0;for(S=l.length;E<S;++E)h=l[E],y?x=u.gecko?t("style"):t("link",{href:h,rel:"stylesheet"}):(x=t("script",{src:h}),x.async=!1),x.className="lazyload",x.setAttribute("charset","utf-8"),u.ie&&!y?x.onreadystatechange=function(){if(/loaded|complete/.test(x.readyState))x.onreadystatechange=null,g()}:y&&(u.gecko||u.webkit)?u.webkit?(T.urls[E]=x.href,o()):(x.innerHTML='@import "'+h+'";',s(x)):x.onload=x.onerror=g,b.push(x);E=0;for(S=b.length;E<S;++E)a.appendChild(b[E])}}function s(e){var t;try{t=!!e.sheet.cssRules}catch(r){l+=1;l<200?setTimeout(function(){s(e)},50):t&&n("css");return}n("css")}function o(){var e=f.css,t;if(e){for(t=h.length;--t>=0;)if(h[t].href===e.urls[0]){n("css");break}l+=1;e&&(l<200?setTimeout(o,50):n("css"))}}var u,a,f={},l=0,c={css:[],js:[]},h=e.styleSheets;return{css:function(e,t,n,r){i("css",e,t,n,r)},js:function(e,t,n,r){i("js",e,t,n,r)}}}(this.document);(function(e){e(document).ready(function(){Drupal={};Drupal.settings={};Drupal.settings.drupalchat=iflychat;Drupal.settings.basePath=Drupal.settings.drupalchat.basePath;if(false&&drupalchatReadCookie("iflychat_key")&&drupalchatReadCookie("iflychat_css")&&Drupal.settings.drupalchat.chat_type==="2"){var e={key:drupalchatReadCookie("iflychat_key"),css:drupalchatReadCookie("iflychat_css"),cache:"1"};drupalchatCheckUrl(Drupal.settings.drupalchat.external_a_host+":"+Drupal.settings.drupalchat.external_a_port+"/i/"+drupalchatReadCookie("iflychat_css")+"/cache.css",e)}else{drupalchatForceLoad()}})})(jQuery)